# =============================================================================
# VLAN Network Profile - 802.1Q VLAN Tagging
# =============================================================================
#
# TOPOLOGY:
#   eth1 (trunk) --> eth1.200 (cluster)  - 192.168.200.0/24
#                --> eth1.100 (storage)  - 192.168.100.0/24
#
# USAGE:
#   Deploy to /etc/netplan/60-k3s-network.yaml
#   Replace @CLUSTER_IP@ with cluster VLAN IP (e.g., 192.168.200.1)
#   Replace @STORAGE_IP@ with storage VLAN IP (e.g., 192.168.100.1)
#
# VLAN IDs:
#   - VLAN 200: Cluster traffic (k3s API, flannel overlay)
#   - VLAN 100: Storage traffic (Longhorn, iSCSI)
#
# QEMU TEST NOTE:
#   - eth0: QEMU NAT for external access (used by backdoor/test driver)
#   - eth1: k3s cluster trunk (VLANs configured here)
#
# =============================================================================

network:
  version: 2
  renderer: networkd

  ethernets:
    # Trunk interface - no IP, just carries tagged traffic
    eth1: {}

  vlans:
    # Cluster VLAN (k3s API, flannel)
    eth1.200:
      id: 200
      link: eth1
      addresses:
        - @CLUSTER_IP@/24

    # Storage VLAN (Longhorn, iSCSI)
    eth1.100:
      id: 100
      link: eth1
      addresses:
        - @STORAGE_IP@/24
