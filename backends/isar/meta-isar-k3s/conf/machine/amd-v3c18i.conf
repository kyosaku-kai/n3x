#
# AMD V3C18i (Fox board) machine configuration for Isar
#
# Hardware: AMD Ryzen Embedded V3000 series (V3C18I variant)
# - No integrated GPU - serial console required
# - Serial: UART0 (J38) -> ttyS4, 115200n8
# - UEFI boot with GRUB
# - Standard x86_64 architecture
#
# References:
# - AMD/57102_1.01_Platform-Users-Guide-FOX-V3000.pdf
# - AMD/56149_0.50_Remote-Headless-Mode-V3000-FOX.pdf
#

DISTRO_ARCH ?= "amd64"

KERNEL_NAME ?= "amd64"

# UEFI boot with GPT partitioning
IMAGE_FSTYPES ?= "wic"
WKS_FILE ?= "efi-plus-pcbios"

# Bootloader installation (GRUB EFI + legacy BIOS fallback)
IMAGER_INSTALL:wic += " \
    ${GRUB_BOOTLOADER_INSTALL} \
    ${SYSLINUX_BOOTLOADER_INSTALL}"

# Serial console configuration
# V3C18I: UART0 (J38 connector) maps to ttyS4
MACHINE_SERIAL ?= "ttyS4"
BAUDRATE_TTY ?= "115200"

# Required firmware packages for AMD V3000
# - amd64-microcode: CPU microcode updates (security critical)
# Note: linux-firmware not needed - V3C18i has no iGPU (headless board)
# If dGPU is added later, install firmware-linux-nonfree (requires non-free repo)
IMAGE_PREINSTALL:append = " amd64-microcode"
