# CI Build Cache Configuration
#
# Overrides DL_DIR and SSTATE_DIR to use kas-container's forwarded mount
# paths. When these environment variables are set on the host, kas-container
# mounts the host directories at /downloads and /sstate inside the container.
# This overlay ensures BitBake uses those paths instead of the defaults
# from base.yml (which reference ${HOME}/.cache/yocto/).
#
# This overlay must appear AFTER base.yml in the kas config chain so that
# its local_conf_header entries override base.yml's assignments.
#
# Usage (CI only):
#   DL_DIR=/host/cache/downloads SSTATE_DIR=/host/cache/sstate \
#     kas-container --isar build kas/base.yml:...:kas/opt/ci-cache.yml

header:
  version: 14

local_conf_header:
  # Key MUST sort alphabetically after base.yml's "shared-cache" key.
  # kas merges local_conf_header entries by key name and writes them
  # in sorted order. BitBake uses last-assignment-wins, so this key
  # ("zzz-ci-cache") ensures our DL_DIR/SSTATE_DIR override takes effect.
  zzz-ci-cache: |
    DL_DIR = "/downloads"
    SSTATE_DIR = "/sstate"
