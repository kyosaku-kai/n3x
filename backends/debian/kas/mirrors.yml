# Mirror Configuration (Public Upstream — Default)
# =============================================================================
#
# PURPOSE:
#   Centralizes all external URLs into one overlay. This file is auto-included
#   by kas/base.yml so all builds get consistent URL definitions.
#
#   Recipes reference BitBake variables (NVIDIA_L4T_MIRROR, KERNEL_MIRROR)
#   in SRC_URI instead of hardcoding URLs, enabling easy URL switching.
#
# INTERNAL MIRRORS (future):
#   When internal mirrors are provisioned (Plan 023), either:
#   (a) Edit the URLs in this file directly, or
#   (b) Create a mirrors-internal.yml overlay that overrides these values
#       and append it to build commands.
#
#   See docs/internal-mirror-registry.md for the full mirror mapping.
#
# =============================================================================

header:
  version: 14

# ISAR framework repository (fork with do_adjust_git symlink fix)
#
# Fork of ilbers/isar with fix for dangling symlink handling in
# dpkg-base.bbclass do_adjust_git(). os.path.exists() follows symlinks
# and misses dangling ones, causing FileExistsError when DL_DIR mount
# paths change between kas-container sessions.
#
# Fix: os.path.exists() → os.path.lexists() on lines 30 and 33.
# Upstream issue: https://github.com/ilbers/isar/issues/PENDING
# Upstream PR: https://github.com/ilbers/isar/pull/PENDING
#
# TODO: Revert to upstream ilbers/isar once fix is merged.
repos:
  isar:
    url: https://github.com/kyosaku-kai/isar.git
    commit: 62a2db1545a8d5dd811d3ad7caa3107fb51e256e
    layers:
      meta:
      meta-isar:

# BitBake variables for recipe SRC_URI references
local_conf_header:
  mirrors-config: |
    # Mirror base URLs for binary downloads and source tarballs.
    # Recipes reference these variables in SRC_URI instead of hardcoding URLs.
    # To switch to internal mirrors, update these values (see header comment).
    NVIDIA_L4T_MIRROR = "https://repo.download.nvidia.com/jetson"
    KERNEL_MIRROR = "https://cdn.kernel.org/pub/linux/kernel"
